import{d as Qt,r as Jt,o as Xt,c as Zt,b as te,i as ee,_ as ne}from"./index-a_sggHWe.js";const ut=`
`,J="	",$="=",Y='"',F=" ",j="[",K="]",v="/",H="\\",tt=t=>typeof t=="object"&&!!t.tag,Ot=t=>typeof t=="string",Ct=(t,e,n)=>Object.keys(t).reduce(e,n),xt=t=>tt(t)?t.content.reduce((e,n)=>e+xt(n),0):Ot(t)?t.length:0,se=(t,e)=>{t.content.push(e)},dt=t=>t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/(javascript|data|vbscript):/gi,"$1%3A"),wt=(t,e)=>{const n=typeof e,s={boolean:()=>e?`${t}`:"",number:()=>`${t}="${e}"`,string:()=>`${t}="${dt(e)}"`,object:()=>`${t}="${dt(JSON.stringify(e))}"`};return s[n]?s[n]():""},et=t=>t==null?"":Ct(t,(e,n)=>[...e,wt(n,t[n])],[""]).join(" "),q=t=>Ct(t,(e,n)=>t[n]===n?t[n]:null,null),re=(t,e)=>{const n=q(e);if(n){const s=wt(t,n),i={...e};delete i[n];const l=et(i);return`${s}${l}`}return`${t}${et(e)}`};class G{attr(e,n){return typeof n<"u"&&(this.attrs[e]=n),this.attrs[e]}append(e){return se(this,e)}get length(){return xt(this)}toTagStart({openTag:e=j,closeTag:n=K}={}){const s=re(this.tag,this.attrs);return`${e}${s}${n}`}toTagEnd({openTag:e=j,closeTag:n=K}={}){return`${e}${v}${this.tag}${n}`}toTagNode(){return new G(this.tag.toLowerCase(),this.attrs,this.content)}toString({openTag:e=j,closeTag:n=K}={}){const s=this.content.length===0,i=this.content.reduce((c,C)=>c+C.toString({openTag:e,closeTag:n}),""),l=this.toTagStart({openTag:e,closeTag:n});return s?l:`${l}${i}${this.toTagEnd({openTag:e,closeTag:n})}`}constructor(e,n,s){this.tag=e,this.attrs=n,this.content=Array.isArray(s)?s:[s]}}G.create=(t,e={},n=[])=>new G(t,e,n);G.isOf=(t,e)=>t.tag===e;const m="type",lt="value",Rt="row",Wt="line",$t=1,Gt=2,Pt=3,Mt=4,Vt=5,Dt=6,st=t=>t&&typeof t[lt]<"u"?t[lt]:"",oe=t=>t&&t[Wt]||0,ie=t=>t&&t[Rt]||0,ce=t=>t&&typeof t[m]<"u"?t[m]===Vt||t[m]===Dt||t[m]===$t:!1,ae=t=>t&&typeof t[m]<"u"?t[m]===Gt:!1,ft=t=>st(t).charCodeAt(0)===v.charCodeAt(0),ue=t=>!ft(t),le=t=>t&&typeof t[m]<"u"?t[m]===Pt:!1,Te=t=>t&&typeof t[m]<"u"?t[m]===Mt:!1,fe=t=>{const e=st(t);return ft(t)?e.slice(1):e},ge=t=>{let e=j;return e+=st(t),e+=K,e};class Ae{isEmpty(){return isNaN(this[m])}isText(){return ce(this)}isTag(){return ae(this)}isAttrName(){return le(this)}isAttrValue(){return Te(this)}isStart(){return ue(this)}isEnd(){return ft(this)}getName(){return fe(this)}getValue(){return st(this)}getLine(){return oe(this)}getColumn(){return ie(this)}toString(){return ge(this)}constructor(e,n,s,i){this[m]=Number(e),this[lt]=String(n),this[Wt]=Number(s),this[Rt]=Number(i)}}const I=$t,_t=Gt,he=Pt,Nt=Mt,pe=Vt,Ee=Dt;function de(t,e){const n={pos:0,len:t.length},s=f=>{const{pos:A}=n,E=t.indexOf(f,A);return E>=0?t.substring(A,E):""},i=f=>t.indexOf(f,n.pos)>=0,l=()=>n.len>n.pos,c=()=>n.pos===n.len,C=(f=1,A)=>{n.pos+=f,e&&e.onSkip&&!A&&e.onSkip()},T=()=>t.substring(n.pos),O=(f=0)=>t.substring(n.pos,n.pos+f),d=()=>t[n.pos],N=()=>{const f=n.pos-1;return typeof t[f]<"u"?t[f]:null},x=()=>{const f=n.pos+1;return f<=t.length-1?t[f]:null},S=(f,A)=>{let E=0;if(l())for(E=n.pos;l()&&f(d());)C(1,A);return t.substring(E,n.pos)};this.skip=C,this.hasNext=l,this.getCurr=d,this.getRest=T,this.getNext=x,this.getPrev=N,this.isLast=c,this.includes=i,this.grabWhile=S,this.grabN=O,this.substrUntilChar=s}const St=(t,e)=>new de(t,e),_e=(t,e)=>{for(;t.charAt(0)===e;)t=t.substring(1);for(;t.charAt(t.length-1)===e;)t=t.substring(0,t.length-1);return t},Ne=t=>t.replace(H+Y,Y);function Se(t=[]){const e=t,n=()=>Array.isArray(e)&&e.length>0&&typeof e[e.length-1]<"u"?e[e.length-1]:null,s=()=>e.length?e.pop():!1,i=c=>e.push(c),l=()=>e;this.push=i,this.toArray=l,this.getLast=n,this.flushLast=s}const X=(t=[])=>new Se(t),be="!",ye=(t,e,n=0,s=0)=>new Ae(t,e,n,s);function Le(t,e={}){let T=0,O=0,d=-1,N=0,x=0,S="";const f=new Array(Math.floor(t.length)),A=e.openTag||j,E=e.closeTag||K,z=!!e.enableEscapeTags,w=e.contextFreeTags||[],rt=e.onToken||(()=>{}),ot=[E,A,Y,H,F,J,$,ut,be],it=[A,F,J,ut],ct=[F,J],at=[$,F,J],B=o=>ot.indexOf(o)>=0,r=o=>o===ut,a=o=>ct.indexOf(o)>=0,g=o=>it.indexOf(o)===-1,R=o=>at.indexOf(o)>=0,P=o=>o===A||o===E||o===H,gt=o=>o===H,At=()=>{O++},ht=o=>Ne(_e(o,Y)),pt=(o,h)=>{S!==""&&h&&(S=""),S===""&&w.includes(o)&&(S=o)},u=St(t,{onSkip:At});function _(o,h){const p=ye(o,h,T,O);rt(p),d+=1,f[d]=p}function kt(o,h){if(x===1){const y=Q=>!(Q===$||a(Q)),M=o.grabWhile(y),V=o.isLast(),D=o.getCurr()!==$;return o.skip(),V||D?_(Nt,ht(M)):_(he,M),V?0:D?1:2}if(x===2){let y=!1;const M=D=>{const Q=D===Y,Ft=o.getPrev(),Et=o.getNext(),Ht=Ft===H,Yt=Et===$,qt=a(D),zt=a(Et);return y&&R(D)?!0:Q&&!Ht&&(y=!y,!y&&!(Yt||zt))?!1:h?!0:qt===!1},V=o.grabWhile(M);return o.skip(),_(Nt,ht(V)),o.isLast()?0:1}const p=y=>!(y===$||a(y)||o.isLast()),b=o.grabWhile(p);return _(_t,b),pt(b),o.skip(),h?2:o.includes($)?1:2}function vt(){const o=u.getCurr(),h=u.getNext();u.skip();const p=u.substrUntilChar(E),b=p.length===0||p.indexOf(A)>=0;if(B(h)||b||u.isLast())return _(I,o),0;const W=p.indexOf($)===-1,y=p[0]===v;if(W||y){const M=u.grabWhile(V=>V!==E);return u.skip(),_(_t,M),pt(M,y),0}return 2}function jt(){const h=u.grabWhile(W=>W!==E,!0),p=St(h,{onSkip:At}),b=p.includes(F);for(x=0;p.hasNext();)x=kt(p,!b);return u.skip(),0}function Kt(){if(r(u.getCurr()))return _(Ee,u.getCurr()),u.skip(),O=0,T++,0;if(a(u.getCurr())){const h=u.grabWhile(a);return _(pe,h),0}if(u.getCurr()===A){if(S){const h=A.length+v.length+S.length,p=`${A}${v}${S}`;if(u.grabN(h)===p)return 1}else if(u.includes(E))return 1;return _(I,u.getCurr()),u.skip(),0}if(z){if(gt(u.getCurr())){const b=u.getCurr(),W=u.getNext();return u.skip(),P(W)?(u.skip(),_(I,W),0):(_(I,b),0)}const h=b=>g(b)&&!gt(b),p=u.grabWhile(h);return _(I,p),0}const o=u.grabWhile(g);return _(I,o),0}function Ut(){for(N=0;u.hasNext();)switch(N){case 1:N=vt();break;case 2:N=jt();break;case 0:default:N=Kt();break}return f.length=d+1,f}function Bt(o){const h=A+v+o.getValue();return t.indexOf(h)>-1}return{tokenize:Ut,isTokenNested:Bt}}const me=(t,e={})=>{const n=e,s=n.openTag||j,i=n.closeTag||K,l=(n.onlyAllowTags||[]).filter(Boolean).map(r=>r.toLowerCase());let c=null;const C=X(),T=X(),O=X(),d=X(),N=new Set,x=r=>{const a=r.getValue();return!N.has(a)&&c.isTokenNested&&c.isTokenNested(r)?(N.add(a),!0):N.has(a)},S=r=>!!N.has(r),f=r=>l.length?l.indexOf(r.toLowerCase())>=0:!0,A=()=>{O.flushLast()&&d.flushLast()},E=()=>{const r=T.getLast();return r&&Array.isArray(r.content)?r.content:C.toArray()},z=(r,a=!0)=>{const g=E();Array.isArray(g)&&(g.push(r.toTagStart({openTag:s,closeTag:i})),r.content.length&&(r.content.forEach(R=>{g.push(R)}),a&&g.push(r.toTagEnd({openTag:s,closeTag:i}))))},w=r=>{const a=E();Array.isArray(a)&&(tt(r)?f(r.tag)?a.push(r.toTagNode()):z(r):a.push(r))},rt=r=>{A();const a=G.create(r.getValue()),g=x(r);O.push(a),g?T.push(a):w(a)},ot=r=>{A();const a=T.flushLast();if(a)w(a);else if(typeof n.onError=="function"){const g=r.getValue(),R=r.getLine(),P=r.getColumn();n.onError({message:`Inconsistent tag '${g}' on line ${R} and column ${P}`,tagName:g,lineNumber:R,columnNumber:P})}},it=r=>{r.isStart()&&rt(r),r.isEnd()&&ot(r)},ct=r=>{const a=O.getLast(),g=r.getValue(),R=S(r);if(a)if(r.isAttrName())d.push(g),a.attr(d.getLast(),"");else if(r.isAttrValue()){const P=d.getLast();P?(a.attr(P,g),d.flushLast()):a.attr(g,g)}else r.isText()?R?a.append(g):w(g):r.isTag()&&w(r.toString());else r.isText()?w(g):r.isTag()&&w(r.toString())},at=r=>{r.isTag()?it(r):ct(r)};c=(e.createTokenizer?e.createTokenizer:Le)(t,{onToken:at,openTag:s,closeTag:i,onlyAllowTags:n.onlyAllowTags,contextFreeTags:n.contextFreeTags,enableEscapeTags:n.enableEscapeTags}),c.tokenize();const B=T.flushLast();return B&&S(B.tag)&&z(B,!1),C.toArray()},Tt=t=>typeof t=="object",Oe=t=>typeof t=="boolean";function U(t,e){const n=t;if(Array.isArray(n))for(let s=0;s<n.length;s++)n[s]=U(e(n[s]),e);else n&&Tt(n)&&n.content&&U(n.content,e);return n}function nt(t,e){return typeof t!=typeof e?!1:!Tt(t)||t===null?t===e:Array.isArray(t)?t.every(n=>[].some.call(e,s=>nt(n,s))):Object.keys(t).every(n=>{const s=e[n],i=t[n];return Tt(i)&&i!==null&&s!==null?nt(i,s):Oe(i)?i!==(s===null):s===i})}function bt(t,e){return Array.isArray(t)?U(this,n=>{for(let s=0;s<t.length;s++)if(nt(t[s],n))return e(n);return n}):U(this,n=>nt(t,n)?e(n):n)}function Ce(t){return U(this,t)}function xe(t){const e=typeof t=="function"?[t]:t||[];let n={skipParse:!1};return{process(s,i){n=i||{};const l=n.parser||me,c=n.render,C=n.data||null;if(typeof l!="function")throw new Error('"parser" is not a function, please pass to "process(input, { parser })" right function');let T=n.skipParse?s||[]:l(s,n);const O=T;return T.messages=[],T.options=n,T.walk=Ce,T.match=bt,e.forEach(d=>{T=d(T,{parse:l,render:c,iterate:U,match:bt,data:C})||T}),{get html(){if(typeof c!="function")throw new Error('"render" function not defined, please pass to "process(input, { render })"');return c(T,T.options)},tree:T,raw:O,messages:T.messages}}}}const we="/>",Re="</",yt="<",Lt=">",We=(t,{stripTags:e=!1})=>{if(!t)return"";const n=typeof t;return n==="string"||n==="number"?t:n==="object"?e===!0?Z(t.content,{stripTags:e}):t.content===null?[yt,t.tag,et(t.attrs),we].join(""):[yt,t.tag,et(t.attrs),Lt,Z(t.content),Re,t.tag,Lt].join(""):Array.isArray(t)?Z(t,{stripTags:e}):""},Z=(t,{stripTags:e=!1}={})=>[].concat(t).reduce((n,s)=>n+We(s,{stripTags:e}),""),$e=(t,e,n)=>xe(e).process(t,{...n,render:Z}).html,Ge=t=>typeof t=="object"&&!!t.tag;function Pe(t,e,n,s){e.walk(i=>Ge(i)&&t[i.tag]?t[i.tag](i,n,s):i)}function It(t,e=Pe){const n=(s={})=>{n.options=Object.assign(n.options||{},s);const i=(l,c)=>e(t,l,c,n.options);return i.options=n.options,i};return n.extend=s=>It(s(t,n.options),e),n}const Me=(t,e)=>t[0]===e,mt={color:t=>`color:${t};`,size:t=>`font-size:${t};`},Ve=t=>Object.keys(t).reduce((e,n)=>mt[n]?e.concat(mt[n](t[n])):e,[]).join(" "),De=t=>{let e=0;const n=[],s=()=>G.create("li"),i=c=>{n[e]=n[e]||c},l=c=>{n[e]&&n[e].content?n[e].content=n[e].content.concat(c):n[e]=n[e].concat(c)};return t.forEach(c=>{Ot(c)&&Me(c,"*")?(n[e]&&e++,i(s()),l(c.substr(1))):tt(c)&&G.isOf(c,"*")?(n[e]&&e++,i(s())):tt(n[e])?n[e]?l(c):i(c):(e++,i(c))}),[].concat(n)},Ie=(t,e)=>q(t.attrs)?q(t.attrs):e(t.content),L=(t,e,n)=>({tag:t,attrs:e,content:n}),k=t=>({style:t}),ke={b:t=>L("span",k("font-weight: bold;"),t.content),i:t=>L("span",k("font-style: italic;"),t.content),u:t=>L("span",k("text-decoration: underline;"),t.content),s:t=>L("span",k("text-decoration: line-through;"),t.content),url:(t,{render:e},n)=>L("a",{href:Ie(t,e)},t.content),img:(t,{render:e})=>L("img",{src:e(t.content)},null),quote:t=>L("blockquote",{},[L("p",{},t.content)]),code:t=>L("pre",{},t.content),style:t=>L("span",k(Ve(t.attrs)),t.content),list:t=>{const e=q(t.attrs);return L(e?"ol":"ul",e?{type:e}:{},De(t.content))},color:t=>L("span",k(`color: ${q(t.attrs)};`),t.content)},ve=It(ke),je={class:"bbcode"},Ke=["innerHTML"],Ue=Qt({__name:"BBCodeView",setup(t){const e=Jt(""),s={setCode:i=>{e.value=$e(i.code||"",ve())}};return Xt(()=>{window.bbcode=s,window.mounted=!0}),(i,l)=>(ee(),Zt("div",je,[te("div",{innerHTML:e.value},null,8,Ke)]))}}),Fe=ne(Ue,[["__scopeId","data-v-a57e7426"]]);export{Fe as default};
