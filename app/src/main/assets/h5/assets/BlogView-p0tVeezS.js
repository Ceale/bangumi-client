import{d as S,r as a,a as V,o as T,c as s,b as l,t as m,w as x,e as i,u as b,F as N,f as R,g as w,h as k,n as y,i as d}from"./index-a_sggHWe.js";import{c as u,R as D,C as L,B as M,a as H,W as J}from"./BottomSpinnerView-FbERe0wp.js";const U={key:0,class:"blog",id:"blog"},F={class:"blog-title"},P=["onClick"],z={class:"blog-author"},E={class:"blog-time"},O=["innerHTML"],W={key:0,class:"blog-tag"},q=l("div",{class:"tip"},"标签：",-1),A={class:"blog-tag-item"},G={key:1,class:"divider"},Y=S({__name:"BlogView",setup(K){const o=a({}),h=a(),f=a(new Date().getDate());let g=10;const v=a(1),c=a("default"),r=V([]),p=a("哼！Bangumi老娘我是有底线的人"),B={loadBlogDetail:async e=>{o.value=e,e.anchorCommentId.length>0&&(g=1e4,await C(null)),await y(),u.optContentJs(h.value),u.scrollToTargetComment(e.anchorCommentId)}},C=async e=>{const n=window.android.onCommentSort(c.value),t=window.android.onLoadComments(v.value,g,n),_=JSON.parse(t);c.value=n,_.length==0?e==null||e.complete():(r.push(..._),v.value++,await y(),_.length<g?e==null||e.complete():e==null||e.loaded())},I=()=>{var n,t;const e=((n=o.value)==null?void 0:n.userId)||"";window.android&&e&&window.android&&window.android.onClickUser(e,(t=o.value)==null?void 0:t.id)};return T(()=>{window.robotSay=e=>{p.value=e},u.initComment(null,()=>r,e=>{c.value=e,v.value=1,r.length=0,f.value++}),window.blog=B,window.mounted=!0}),(e,n)=>o.value.id?(d(),s("div",U,[l("div",F,m(o.value.title),1),l("div",{class:"blog-info",onClick:x(I,["stop"])},[l("div",z,m(o.value.userName),1),l("div",E,m(o.value.time),1)],8,P),i(D,{related:o.value.related},null,8,["related"]),l("div",{class:"blog-content",ref_key:"blogContentRef",ref:h,innerHTML:b(u).optText(o.value.content)},null,8,O),(o.value.tags||[]).length>0?(d(),s("div",W,[q,(d(!0),s(N,null,R(o.value.tags||[],t=>(d(),s("div",A,m(t.title),1))),256))])):w("",!0),o.value.content?(d(),s("div",G)):w("",!0),i(L,{target:"#blog",comments:r,sort:c.value,"master-id":o.value.userId,"anchor-id":o.value.anchorCommentId},null,8,["comments","sort","master-id","anchor-id"]),i(b(J),{class:"loading",target:"#blog",identifier:f.value,distance:300,onInfinite:C},{spinner:k(()=>[i(M)]),complete:k(()=>[i(H,{message:p.value},null,8,["message"])]),_:1},8,["identifier"])])):w("",!0)}});export{Y as default};
